//
// Export to...
//
// dzslides without embedded assets:
// asciidoc slides.asciidoc
//
// dzslides with embedded assets:
// asciidoc -a data-uri -a linkcss! slides.asciidoc
//
// HTML5:
// asciidoc -b html5 -o outline.html slides.asciidoc
//
*WebSocket* The Current State of the Most Valuable HTML5 API
==============================================================
Viktor Gamov, @gamussa <viktor.gamov@faratasystems.com>
v0.1, Feb 24, 2013
:title: WebSockets: The Current State of the Most Valuable HTML5 API
:description: Slides for presentation about WebSocket HTML5 API.
:copyright: CC BY-SA 2.0
:website: http://faratasystems.com
:imagesdir: images
:backend: dzslides
:linkcss: true
:dzslides-style: stormy
:dzslides-transition: fade
:dzslides-fonts: family=Yanone+Kaffeesatz:400,700,200,300&family=Cedarville+Cursive
:dzslides-highlight: github
// disable syntax highlighting unless turned on explicitly
:syntax: no-highlight

[{topic}]
== Agenda

[{stepwise}]
- Bit Of History
- Meet WebSocket
- WebSocket in Action

//image::HTML5_Connectivity_512.png[role="middle", scaleheight=50%, scaleweight=50%] 

[{recap-final}]
== “LEGACY” WEB

[{stepwise}]
- Polling
- Long Polling
- Streaming

== ||

*POLLING*

Browser sends HTTP requests at regular intervals and immediately receives a response. However, real- time data is often not that predictable, making unnecessary requests inevitable and as a result, many connections are opened and closed needlessly in low-message-rate situations

== ||

*LONG-POLLING*

Browser sends a request to the server and the server keeps the request open for a set period of time. If a notification is received within that period, a response containing the message is sent to the client. If a notification is not received within the set time period, the server sends a response to terminate the open request.

== ||

[quote, www.ietf.org/mail-archive/web/hybi/current/msg00784.html]
____
Reducing kilobytes of data to 2 bytes... and reducing latency from 150ms to 50 ms is far more than marginal. In fact, these two factors alone are enough to make WebSocket seriously interesting...
____

[{topic}]
== Meet the *WEB SOCKET*

[{stepwise-alt}]
* STANDARD PROTOCOL [detail]#Websocket is a standardized technology (described in RFC6455) to support low‐overhead bidirectional traffic from your Web browser.#
* CLIENT-SIDE API [detail]#HTML5 specification introduces WebSocket client side object. No plugin required#
* SERVER-SIDE API [detail]#True real-time server updates. Expected large penetration in Java world with upcoming JavaEE 7 spec and JSR-356#

//[role="topic source lhs"]
[role="topic"]
== WebSocket Interface 

[syntax="java"]
----------------------------------------------------------------------
[Constructor(DOMString url, optional (DOMString or DOMString[]) protocols)]
interface WebSocket : EventTarget {
  readonly attribute DOMString url;

  // ready state
  const unsigned short CONNECTING = 0;
  const unsigned short OPEN = 1;
  const unsigned short CLOSING = 2;
  const unsigned short CLOSED = 3;
  readonly attribute unsigned short readyState;
  readonly attribute unsigned long bufferedAmount;

  // networking
  [TreatNonCallableAsNull] attribute Function? onopen;
  [TreatNonCallableAsNull] attribute Function? onerror;
  [TreatNonCallableAsNull] attribute Function? onclose;
  readonly attribute DOMString extensions;
  readonly attribute DOMString protocol;
  void close([Clamp] optional unsigned short code, optional DOMString reason);

  // messaging
  [TreatNonCallableAsNull] attribute Function? onmessage;
           attribute DOMString binaryType;
  void send(DOMString data);
  void send(ArrayBufferView data);
  void send(Blob data);
};
----------------------------------------------------------------------

//[role="topic source lhs"]
== JavaScript API

[syntax="javascript"]
----------------------------------------------------------------------
var ws;
if (window.WebSocket) {
    output("WebSocket supported in your browser");
    ws = new WebSocket("ws://www.websockets.org");

    // Set event handlers.
    ws.onopen = function () {
        output("onopen");
    };
    ws.onmessage = function (e) {
        // e.data contains received string.
        output("echo from server : " + e.data);
    };
    ws.onclose = function () {
        output("onclose");
    };
    ws.onerror = function () {
        output("onerror");
    };

}
else {output("WebSocket not supported in your browser");}
----------------------------------------------------------------------

//[{intro}]
//== *Side* by{nbsp}**side**

[role="topic"]
== WebSocket handshake
To Start full-duplex communication client should send UPGRADE request

[{stepwise-alt}]
- SEND UPGRADE REQUEST
- RECEIVE UPGRADE RESPONSE
- CHANGE READYSTATE TO `open`
- LISTEN `message` EVENT

[{recap-final}]
== USE CASE

WebSockets really shine with following applications:

[{stepwise}]
- Live trading/sports ticker
- Controlling medical equipment over the web
- Chat applications
- Multiplayer online games
- Realtime updating social streams

[{ending}, hrole="name"]
== Thank you for your attention!

[role="footer"]
{website}


////

== Bunch of links

* http://www.w3.org/TR/websockets/ MUST!
* http://tools.ietf.org/html/rfc6455 MUST!
* http://tomcat.apache.org/tomcat-7.0-doc/web-socket-howto.html
* http://websocket-sdk.java.net/Introduction.html
* https://github.com/Atmosphere/atmosphere/wiki/Supported-WebServers-and-Browsers
* http://autobahn.ws/testsuite

////